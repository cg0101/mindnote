import{j as t,v as e,o as n,b as i,k as s,i as o,p as l,f as a,r as d,g as r,F as c,h,l as p,e as m}from"./vendor.7204fa68.js";import{u}from"./util.4d017f6b.js";const g={name:"MindnoteInput",props:{value:Object},data(){return{isSelected:!1,message:this.value,styleObject:{width:"200px"}}},watch:{value:function(t,e){console.log("Prop changed: ",t," | was: ",e),this.message=this.value}},mounted(){this.checkWidth()},methods:{pressEnter:function(){console.log("input > pressEnter",this),this.$emit("hit-enter",this)},pressTab:function(){console.log("input > pressTab"),this.$emit("hit-tab",this)},pressDelete:function(){console.log("input > pressDelete"),""==this.value.name&&this.$emit("hit-delete",this)},hitInput:function(){console.log("hitInput"),this.checkWidth(),this.$emit("press-input",this.treeData)},checkWidth(){if(this.$refs&&this.$refs.inputElment){const t=6;let e=this.$refs.inputElment.offsetWidth;const n=this.$refs.inputElment.scrollWidth;n>e&&(e=n+t);window.innerWidth-e>50&&(this.styleObject.width=e+"px")}}}},I=o("data-v-12a857bc")(((o,l,a,d,r,c)=>t((n(),i("input",{class:{isSelected:r.isSelected},ref:"inputElment",autocomplete:"false",spellcheck:"false",onInput:l[1]||(l[1]=(...t)=>c.hitInput&&c.hitInput(...t)),onKeydown:[l[2]||(l[2]=s(((...t)=>c.pressEnter&&c.pressEnter(...t)),["enter"])),l[3]||(l[3]=s(((...t)=>c.pressTab&&c.pressTab(...t)),["tab"])),l[4]||(l[4]=s(((...t)=>c.pressDelete&&c.pressDelete(...t)),["delete"]))],"onUpdate:modelValue":l[5]||(l[5]=t=>r.message.name=t),style:r.styleObject},null,38)),[[e,r.message.name]])));g.render=I,g.__scopeId="data-v-12a857bc";const f={name:"MindnoteItem",components:{MindnoteInput:g},props:["item"],data(){return{isOpen:!0,value:this.item}},watch:{item:function(t,e){console.log("Prop changed: ",t," | was: ",e),this.value=this.item}},computed:{isFolder:function(){return this.value.children&&this.value.children.length}},methods:{toggle:function(){console.log("item > toggle"),this.isOpen=!this.isOpen},enterItem:function(t){console.log("item > enterItem",this,t),this.$emit("hit-enter",this)},tabItem:function(){console.log("item > tabItem"),this.$emit("hit-tab",this)},deleteItem:function(t){console.log("item > deleteItem",this,t),this.$emit("hit-delete",this)},inputContent:function(){console.log("item > inputContent",this),this.$emit("press-input")}}},v=o("data-v-2cf79249");l("data-v-2cf79249");const b={class:"line-item"},D=r("div",{class:"dot"},null,-1);a();const $=v(((t,e,s,o,l,a)=>{const c=d("mindnote-input");return n(),i("div",b,[r("div",{class:["bullet",{folder:!a.isFolder}],onClick:e[1]||(e[1]=(...t)=>a.toggle&&a.toggle(...t))},[D],2),r(c,{class:"line-content",value:l.value,onHitEnter:a.enterItem,onHitTab:a.tabItem,onHitDelete:a.deleteItem,onPressInput:a.inputContent,ref:"inputitem"},null,8,["value","onHitEnter","onHitTab","onHitDelete","onPressInput"])])}));f.render=$,f.__scopeId="data-v-2cf79249";const _={props:["propsitem"],components:{MindnoteItem:f},data:()=>({isOpen:!0,treeData:[{id:1,name:"Untitled"}]}),beforeMount(){this.propsitem&&this.propsitem.length?this.treeData=this.propsitem:this.treeData=[{id:1,name:"Untitled"}]},watch:{propsitem:function(t,e){console.log("Prop changed: ",t," | was: ",e),this.treeData=this.propsitem}},methods:{toggle(){console.log("child > toggle"),this.isOpen=!this.isOpen},enterItem(t){console.log("child > enterItem",this);const e=t._.vnode.key,n=t.$parent.treeData.length,i=e+1,s={id:n,name:"",remark:"",children:[]};this.treeData.splice(i,0,s),this.$nextTick((()=>this.$el.children[i].querySelector("input").focus())),this.$emit("press-input")},addSubitem(){console.log("child > addSubitem",this.treeData),this.$emit("add-subitem",this.treeData),this.isOpen=!0},tabItem(t){console.log("child > tabItem",t);const e=t._.vnode.key;if(e){const n=t._.vnode.key-1,i=t.$parent.treeData[n];i.children||(i.children=[]),i.children.push(t.value),t.$parent.treeData.splice(e,1),this.$emit("press-input"),setTimeout((()=>{this.$el.querySelector(".mindnote-children").querySelector("input").focus()}),100)}else console.log("child > tabItem > input > focus")},deleteItem(t){console.log("child > deleteItem",this.treeData);const e=t._.vnode.key;t.$parent.treeData.splice(e,1),this.$emit("delete-item")},inputContent(){console.log("child > inputContent",this),this.$emit("press-input")}}},M=o("data-v-5c6f78d6");l("data-v-5c6f78d6");const y={class:"mindnote"},T={key:0,class:"mindnote-children"},k=r("div",{class:"mindnote-children__connection"},null,-1);a();const S=M(((e,s,o,l,a,u)=>{const g=d("mindnote-item"),I=d("_self");return n(),i("div",y,[(n(!0),i(c,null,h(a.treeData,((e,s)=>(n(),i("div",{key:s,ref:"treeData"},[r(g,{key:s,ref:"mindnoteTree",item:e,onHitEnter:u.enterItem,onHitTab:u.tabItem,onHitDelete:u.deleteItem,onPressInput:u.inputContent},null,8,["item","onHitEnter","onHitTab","onHitDelete","onPressInput"]),e.children&&e.children.length?t((n(),i("div",T,[k,r(I,{propsitem:e.children,onPressInput:u.inputContent,onAddSubitem:u.inputContent},null,8,["propsitem","onPressInput","onAddSubitem"])],512)),[[p,a.isOpen]]):m("",!0)],512)))),128))])}));_.render=S,_.__scopeId="data-v-5c6f78d6";l("data-v-be08d116"),a();const C={name:"MindnotePage",components:{Mindnote:_},data(){return{title:this.getDefaultTitle(),listItemData:[],rootItem:{name:"Untitled"}}},created(){this.getData(),this.$nextTick((()=>this.$refs.title.focus()))},methods:{getData(){const t=u.getLocalStorage(this.getMindnoteId());this.listItemData=t},saveMindnote(){console.log("saveMindnote",this.listItemData),u.setLocalStorage(this.getMindnoteId(),this.listItemData)},getMindnoteId(){return this.$route.params.mindnoteId},getDefaultTitle(){let t=this.fetchMindnoteById(this.getMindnoteId());return t?t.name:""},fetchMindnoteById(t){return this.fetchLocalDb().find((e=>e.id==t))},fetchLocalDb:()=>u.getLocalStorage("z-mindnoteItems"),onTitleChange(){let t=this.fetchLocalDb(),e=this.fetchMindnoteById(this.getMindnoteId()),n=t.findIndex((t=>t.id==e.id));e&&(e.name=this.title,t[n]=e,u.setLocalStorage("z-mindnoteItems",t))}},mounted(){}},E=o("data-v-041924db");l("data-v-041924db");const H={class:"pape-mindnote"},O={class:"pape-mindnote__bd"},P={class:"pape-mindnote__bd__title"},w={class:"pape-mindnote__bd__tree"};a();const j=E(((s,o,l,a,c,h)=>{const p=d("mindnote");return n(),i("div",H,[r("div",O,[r("div",P,[t(r("input",{type:"text",placeholder:"无标题","onUpdate:modelValue":o[1]||(o[1]=t=>c.title=t),onChange:o[2]||(o[2]=(...t)=>h.onTitleChange&&h.onTitleChange(...t)),ref:"title",class:"input-title"},null,544),[[e,c.title]])]),r("div",w,[r(p,{class:"mindnote",ref:"mindnote",propsitem:c.listItemData,onPressInput:h.saveMindnote,onAddSubitem:h.saveMindnote,onDeleteItem:h.saveMindnote},null,8,["propsitem","onPressInput","onAddSubitem","onDeleteItem"])])])])}));C.render=j,C.__scopeId="data-v-041924db";export default C;
