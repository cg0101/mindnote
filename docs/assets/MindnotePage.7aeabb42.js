import{j as t,v as e,o as n,b as i,k as s,i as o,p as a,f as l,r as d,g as r,F as c,h,l as p,e as m}from"./vendor.7204fa68.js";import{u}from"./util.4d017f6b.js";const f={name:"MindnoteInput",props:{value:Object},data(){return{isSelected:!1,message:this.value,styleObject:{width:"200px"}}},watch:{value:function(t,e){console.log("Prop changed: ",t," | was: ",e),this.message=this.value}},mounted(){this.checkWidth()},methods:{pressEnter:function(){console.log("input > pressEnter",this),this.$emit("hit-enter",this)},pressTab:function(){console.log("input > pressTab"),this.$emit("hit-tab",this)},pressDelete:function(){console.log("input > pressDelete"),""==this.value.name&&this.$emit("hit-delete",this)},hitInput:function(){console.log("hitInput"),this.checkWidth(),this.$emit("press-input",this.treeData)},checkWidth(){if(this.$refs&&this.$refs.inputElment){const t=6;let e=this.$refs.inputElment.offsetWidth;const n=this.$refs.inputElment.scrollWidth;n>e&&(e=n+t);window.innerWidth-e>50&&(this.styleObject.width=e+"px")}}}},g=o("data-v-12a857bc")(((o,a,l,d,r,c)=>t((n(),i("input",{class:{isSelected:r.isSelected},ref:"inputElment",autocomplete:"false",spellcheck:"false",onInput:a[1]||(a[1]=(...t)=>c.hitInput&&c.hitInput(...t)),onKeydown:[a[2]||(a[2]=s(((...t)=>c.pressEnter&&c.pressEnter(...t)),["enter"])),a[3]||(a[3]=s(((...t)=>c.pressTab&&c.pressTab(...t)),["tab"])),a[4]||(a[4]=s(((...t)=>c.pressDelete&&c.pressDelete(...t)),["delete"]))],"onUpdate:modelValue":a[5]||(a[5]=t=>r.message.name=t),style:r.styleObject},null,38)),[[e,r.message.name]])));f.render=g,f.__scopeId="data-v-12a857bc";const I={name:"MindnoteItem",components:{MindnoteInput:f},props:["item"],data(){return{isOpen:!0,value:this.item}},watch:{item:function(t,e){console.log("Prop changed: ",t," | was: ",e),this.value=this.item}},computed:{isFolder:function(){return this.value.children&&this.value.children.length}},methods:{toggle:function(){console.log("item > toggle"),this.isOpen=!this.isOpen},enterItem:function(t){console.log("item > enterItem",this,t),this.$emit("hit-enter",this)},tabItem:function(){console.log("item > tabItem"),this.$emit("hit-tab",this)},deleteItem:function(t){console.log("item > deleteItem",this,t),this.$emit("hit-delete",this)},inputContent:function(){console.log("item > inputContent",this),this.$emit("press-input")}}},b=o("data-v-2cf79249");a("data-v-2cf79249");const v={class:"line-item"},D=r("div",{class:"dot"},null,-1);l();const $=b(((t,e,s,o,a,l)=>{const c=d("mindnote-input");return n(),i("div",v,[r("div",{class:["bullet",{folder:!l.isFolder}],onClick:e[1]||(e[1]=(...t)=>l.toggle&&l.toggle(...t))},[D],2),r(c,{class:"line-content",value:a.value,onHitEnter:l.enterItem,onHitTab:l.tabItem,onHitDelete:l.deleteItem,onPressInput:l.inputContent,ref:"inputitem"},null,8,["value","onHitEnter","onHitTab","onHitDelete","onPressInput"])])}));I.render=$,I.__scopeId="data-v-2cf79249";const _={props:["propsitem"],components:{MindnoteItem:I},data:()=>({isOpen:!0,treeData:[{id:1,name:"Untitled"}]}),beforeMount(){this.propsitem&&this.propsitem.length?this.treeData=this.propsitem:this.treeData=[{id:1,name:"Untitled"}]},watch:{propsitem:function(t,e){console.log("Prop changed: ",t," | was: ",e),this.treeData=this.propsitem}},methods:{toggle(){console.log("child > toggle"),this.isOpen=!this.isOpen},enterItem(t){console.log("child > enterItem",this);const e=t._.vnode.key,n=t.$parent.treeData.length,i=e+1,s={id:n,name:"",remark:"",children:[]};this.treeData.splice(i,0,s),this.$nextTick((()=>this.$el.children[i].querySelector("input").focus()))},addSubitem(){console.log("child > addSubitem",this.treeData),this.$emit("add-subitem",this.treeData),this.isOpen=!0},tabItem(t){console.log("child > tabItem",t);const e=t._.vnode.key;if(e){const n=t._.vnode.key-1,i=t.$parent.treeData[n];i.children||(i.children=[]),i.children.push(t.value),t.$parent.treeData.splice(e,1),this.$emit("press-inputut"),setTimeout((()=>{this.$el.querySelector(".mindnote-children").querySelector("input").focus()}),100)}else console.log("child > tabItem > input > focus")},deleteItem(t){console.log("child > deleteItem",this.treeData);const e=t._.vnode.key;t.$parent.treeData.splice(e,1)},inputContent(){console.log("child > inputContent",this),this.$emit("press-inputut")}}},y=o("data-v-49f8b30b");a("data-v-49f8b30b");const T={class:"mindnote"},k={key:0,class:"mindnote-children"},M=r("div",{class:"mindnote-children__connection"},null,-1);l();const C=y(((e,s,o,a,l,u)=>{const f=d("mindnote-item"),g=d("_self");return n(),i("div",T,[(n(!0),i(c,null,h(l.treeData,((e,s)=>(n(),i("div",{key:s,ref:"treeData"},[r(f,{key:s,ref:"mindnoteTree",item:e,onHitEnter:u.enterItem,onHitTab:u.tabItem,onHitDelete:u.deleteItem,onPressInputut:u.inputContent},null,8,["item","onHitEnter","onHitTab","onHitDelete","onPressInputut"]),e.children&&e.children.length?t((n(),i("div",k,[M,r(g,{propsitem:e.children,onPressInputut:u.inputContent},null,8,["propsitem","onPressInputut"])],512)),[[p,l.isOpen]]):m("",!0)],512)))),128))])}));_.render=C,_.__scopeId="data-v-49f8b30b";a("data-v-3c4d7eeb"),l();const E={name:"MindnotePage",components:{Mindnote:_},props:["mindnoteId"],data(){return{title:this.getDefaultTitle(),listItemData:[],rootItem:{name:"Untitled"}}},created(){this.getData(),this.$nextTick((()=>this.$refs.title.focus()))},methods:{getData(){const t=u.getLocalStorage(this.mindnoteId);this.listItemData=t},pressInput(){u.setLocalStorage(this.mindnoteId,this.listItemData)},getMindnoteId(){return this.$route.params.mindnoteId||this.mindnoteId},getDefaultTitle(){let t=this.fetchMindnoteById(this.getMindnoteId());return t?t.name:""},fetchMindnoteById(t){return this.fetchLocalDb().find((e=>e.id==t))},fetchLocalDb:()=>u.getLocalStorage("z-mindnoteItems"),onTitleChange(){let t=this.fetchLocalDb(),e=this.fetchMindnoteById(this.getMindnoteId()),n=t.findIndex((t=>t.id==e.id));e&&(e.name=this.title,t[n]=e,u.setLocalStorage("z-mindnoteItems",t))}},mounted(){}},H=o("data-v-ad6b2f50");a("data-v-ad6b2f50");const O={class:"pape-mindnote"},P={class:"pape-mindnote__bd"},S={class:"pape-mindnote__bd__title"},w={class:"pape-mindnote__bd__tree"};l();const j=H(((s,o,a,l,c,h)=>{const p=d("mindnote");return n(),i("div",O,[r("div",P,[r("div",S,[t(r("input",{type:"text",placeholder:"无标题","onUpdate:modelValue":o[1]||(o[1]=t=>c.title=t),onChange:o[2]||(o[2]=(...t)=>h.onTitleChange&&h.onTitleChange(...t)),ref:"title",class:"input-title"},null,544),[[e,c.title]])]),r("div",w,[r(p,{class:"mindnote",ref:"mindnote",propsitem:c.listItemData,onPressInput:h.pressInput},null,8,["propsitem","onPressInput"])])])])}));E.render=j,E.__scopeId="data-v-ad6b2f50";export default E;
